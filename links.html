<!DOCTYPE html>
<html dir="rtl" lang="ar">
<head>
    <meta charset="UTF-8">
    <title>Ø¥Ø¯Ø§Ø±Ø© Ù‚Ø§Ø¹Ø¯Ø© Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø¹Ù„Ù…ÙŠÙ† - Ù…Ø¬Ù…Ø¹ Ø£Ø¨ÙŠ Ø¨Ù† ÙƒØ¹Ø¨</title>
    <script>if(sessionStorage.getItem('isAdmin')!=='true') window.location.href="login.html";</script>
    <link rel="stylesheet" href="style.css">
    <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-database-compat.js"></script>
    <style>
        .links-container { max-width: 900px; margin: 30px auto; padding: 20px; background: #fff; border-radius: 15px; box-shadow: 0 5px 20px rgba(0,0,0,0.1); }
        .input-group { display: flex; gap: 10px; margin-bottom: 30px; justify-content: center; }
        input { padding: 12px; border: 1px solid #ddd; border-radius: 8px; width: 200px; }
        table { width: 100%; border-collapse: collapse; }
        th, td { padding: 12px; border-bottom: 1px solid #eee; text-align: center; }
        .btn-copy { background: #3498db; color: white; border: none; padding: 7px 15px; border-radius: 5px; cursor: pointer; }
        .btn-del { background: #e74c3c; color: white; border: none; padding: 7px 15px; border-radius: 5px; cursor: pointer; }
    </style>
</head>
<body>
    <div class="links-container">
        <header style="display: flex; justify-content: space-between; align-items: center;">
            <h2>ğŸ”— Ø¥Ø¯Ø§Ø±Ø© Ø±ÙˆØ§Ø¨Ø· Ø§Ù„Ù…Ø¹Ù„Ù…ÙŠÙ† Ø§Ù„Ù…Ø¹ØªÙ…Ø¯Ø©</h2>
            <a href="admin.html">Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„Ø¥Ø¯Ø§Ø±Ø©</a>
        </header>

        <div class="input-group">
            <input type="text" id="t-name" placeholder="Ø§Ø³Ù… Ø§Ù„Ù…Ø¹Ù„Ù…">
            <input type="text" id="t-id" placeholder="Ø§Ù„Ø±Ù‚Ù… Ø§Ù„ÙˆØ¸ÙŠÙÙŠ">
            <button onclick="addTeacherToDB()" style="background:#2c3e50; color:white; padding:10px 20px; border-radius:8px; cursor:pointer;">Ø¥Ø¶Ø§ÙØ© Ù„Ù„Ù‚Ø§Ø¹Ø¯Ø©</button>
        </div>

        <table>
            <thead>
                <tr>
                    <th>Ø§Ù„Ù…Ø¹Ù„Ù…</th>
                    <th>Ø§Ù„Ø±Ù‚Ù… Ø§Ù„ÙˆØ¸ÙŠÙÙŠ</th>
                    <th>Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª</th>
                </tr>
            </thead>
            <tbody id="teacher-list-body">
                </tbody>
        </table>
    </div>

    <script>
        const firebaseConfig = {
            apiKey: "AIzaSyAuOkZYWzjBTpuWdeibeEWC0tVR87byEEw",
            authDomain: "hader-system.firebaseapp.com",
            projectId: "hader-system",
            storageBucket: "hader-system.firebasestorage.app",
            messagingSenderId: "1039709774940",
            appId: "1:1039709774940:web:078351fe5cb90593473299"
        };
        firebase.initializeApp(firebaseConfig);
        const database = firebase.database();

        // Ø¥Ø¶Ø§ÙØ© Ù…Ø¹Ù„Ù… Ù„Ù„Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø³Ø­Ø§Ø¨ÙŠØ©
        function addTeacherToDB() {
            const name = document.getElementById('t-name').value;
            const id = document.getElementById('t-id').value;
            if(!name || !id) return alert("Ø£ÙƒÙ…Ù„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª");

            database.ref('teachers_database/' + id).set({ name, id }).then(() => {
                alert("ØªÙ… Ø§Ù„Ø­ÙØ¸ Ø¨Ù†Ø¬Ø§Ø­");
                document.getElementById('t-name').value = "";
                document.getElementById('t-id').value = "";
            });
        }

        // Ø¹Ø±Ø¶ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ù…Ø¹ Ø±ÙˆØ§Ø¨Ø·Ù‡Ø§
        database.ref('teachers_database').on('value', (snapshot) => {
            const data = snapshot.val();
            const body = document.getElementById('teacher-list-body');
            body.innerHTML = "";
            
            // ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ø±Ø§Ø¨Ø· Ø§Ù„Ø£Ø³Ø§Ø³ÙŠ (Ø£ÙˆØªÙˆÙ…Ø§ØªÙŠÙƒÙŠØ§Ù‹ Ø³ÙŠØªØ¹Ø±Ù Ø¹Ù„Ù‰ GitHub Pages)
            let baseUrl = window.location.href.split('links.html')[0];

            if(data) {
                for(let id in data) {
                    const t = data[id];
                    const finalLink = `${baseUrl}index.html?id=${t.id}&name=${encodeURIComponent(t.name)}`;
                    
                    body.innerHTML += `
                        <tr>
                            <td><b>${t.name}</b></td>
                            <td>${t.id}</td>
                            <td>
                                <button class="btn-copy" onclick="copyLink('${finalLink}')">ğŸ“‹ Ù†Ø³Ø® Ø§Ù„Ø±Ø§Ø¨Ø·</button>
                                <button class="btn-del" onclick="deleteTeacher('${t.id}')">ğŸ—‘ï¸ Ø­Ø°Ù</button>
                            </td>
                        </tr>`;
                }
            }
        });

        function copyLink(url) {
            navigator.clipboard.writeText(url);
            alert("ØªÙ… Ø§Ù„Ù†Ø³Ø®! Ø£Ø±Ø³Ù„Ù‡ Ø§Ù„Ø¢Ù† Ù„Ù„Ù…Ø¹Ù„Ù….");
        }

        function deleteTeacher(id) {
            if(confirm("Ù‡Ù„ ØªØ±ÙŠØ¯ Ø­Ø°Ù Ø§Ù„Ù…Ø¹Ù„Ù… ÙˆØ±Ø§Ø¨Ø·Ù‡ØŸ")) {
                database.ref('teachers_database/' + id).remove();
            }
        }
    </script>
</body>
</html>