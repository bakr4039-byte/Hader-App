<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <title>إدارة ثانوية الصحافة</title>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>
    <style>
        body { font-family: 'Tajawal', sans-serif; background: #f4f7f6; padding: 20px; }
        .card { background: white; max-width: 900px; margin: auto; padding: 20px; border-radius: 15px; }
        table { width: 100%; border-collapse: collapse; margin-top: 20px; }
        th, td { padding: 12px; border-bottom: 1px solid #eee; text-align: center; }
        .btn-del { background: #e74c3c; color: white; border: none; padding: 5px 10px; border-radius: 5px; cursor: pointer; }
    </style>
</head>
<body>
    <div class="card">
        <h2>إدارة المعلمين</h2>
        <input type="text" id="tName" placeholder="اسم المعلم">
        <input type="text" id="tID" placeholder="رقم الهوية">
        <button onclick="add()">إضافة معلم</button>
        <a href="reports.html" style="float:left">سجل التقارير</a>
        <table>
            <thead><tr><th>المعلم</th><th>الرابط</th><th>إدارة</th></tr></thead>
            <tbody id="T"></tbody>
        </table>
    </div>
    <script>
        const conf = { apiKey: "AIzaSyAuOkZYWzjBTpuWdeibeEWC0tVR87byEEw", databaseURL: "https://hader-system-default-rtdb.firebaseio.com/" };
        firebase.initializeApp(conf); const db = firebase.database();
        function add() {
            const n = document.getElementById('tName').value, i = document.getElementById('tID').value;
            if(n && i) db.ref('teachers/' + i).set({ name: n }).then(() => location.reload());
        }
        function del(i) { if(confirm("حذف وتعطيل الرابط؟")) db.ref('teachers/' + i).remove().then(() => location.reload()); }
        db.ref('teachers').on('value', s => {
            const t = s.val() || {}; const tb = document.getElementById('T'); tb.innerHTML = "";
            Object.keys(t).forEach(id => {
                const link = `https://bakr4039-byte.github.io/Hader-App/index.html?id=${id}`;
                tb.innerHTML += `<tr><td>${t[id].name}</td><td><button onclick="navigator.clipboard.writeText('${link}')">نسخ</button></td><td><button class="btn-del" onclick="del('${id}')">حذف</button></td></tr>`;
            });
        });
    </script>
</body>
</html>